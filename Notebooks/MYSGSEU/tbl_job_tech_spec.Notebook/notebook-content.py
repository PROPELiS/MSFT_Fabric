# Fabric notebook source

# METADATA ********************

# META {
# META   "kernel_info": {
# META     "name": "synapse_pyspark"
# META   },
# META   "dependencies": {
# META     "lakehouse": {
# META       "default_lakehouse": "59aba330-314f-4ff0-8c5b-ad0582b3dc9e",
# META       "default_lakehouse_name": "SILVER",
# META       "default_lakehouse_workspace_id": "de3e35d4-28a5-4df0-a8d1-00feff73469d",
# META       "known_lakehouses": [
# META         {
# META           "id": "59aba330-314f-4ff0-8c5b-ad0582b3dc9e"
# META         },
# META         {
# META           "id": "59693f16-ceb1-40c6-b096-d37b5fbbbd26"
# META         }
# META       ]
# META     }
# META   }
# META }

# PARAMETERS CELL ********************

in_mode = "FULL"  # Replace with the actual IN_MODE value

# METADATA ********************

# META {
# META   "language": "python",
# META   "language_group": "synapse_pyspark"
# META }

# CELL ********************

from pyspark.sql.functions import concat_ws, expr, sha2, size, lit, col, array, struct, udf, current_timestamp, max as spark_max
from functools import reduce
from pyspark.sql.types import *
from pyspark.sql import *
from delta.tables import *
from pyspark.sql import SparkSession
from delta.tables import DeltaTable
from pyspark.sql.types import StructType, StructField, StringType, TimestampType

# Define the schema for the order data
orderSchema = StructType([
           StructField("SYS_CHANGE_VERSION", StringType(), True),
			StructField("SYS_CHANGE_CREATION_VERSION", StringType(), True),
			StructField("SYS_CHANGE_OPERATION", StringType(), True),
			StructField("SYS_CHANGE_COLUMNS", StringType(), True),
			StructField("SYS_CHANGE_CONTEXT", StringType(), True),
			StructField("CT_JobTechSpecId", StringType(), True),
			StructField("JobTechSpecId", StringType(), True),
			StructField("JobVersionId", StringType(), True),
			StructField("JobCategory", StringType(), True),
			StructField("SurfaceReversePrint", StringType(), True),
			StructField("CylinderSize", StringType(), True),
			StructField("ReelWidth", StringType(), True),
			StructField("NumberAroundCylinder", StringType(), True),
			StructField("NumberAcrossCylinder", StringType(), True),
			StructField("Dispro", StringType(), True),
			StructField("DisproDirection", StringType(), True),
			StructField("DisproNonStandard", StringType(), True),
			StructField("PlateType", StringType(), True),
			StructField("PlateThickness", StringType(), True),
			StructField("PlateStagger", StringType(), True),
			StructField("PlateStaggerRolling", StringType(), True),
			StructField("FileName", StringType(), True),
			StructField("JobHeight", StringType(), True),
			StructField("JobWidth", StringType(), True),
			StructField("RotateJob90CDI", StringType(), True),
			StructField("RotateJob90IS", StringType(), True),
			StructField("PCMTypeProfile", StringType(), True),
			StructField("ProductionSystem", StringType(), True),
			StructField("BarcodeNumber", StringType(), True),
			StructField("BarcodeType", StringType(), True),
			StructField("BarcodeCol", StringType(), True),
			StructField("BarcodeLMI", StringType(), True),
			StructField("BarcodeMag", StringType(), True),
			StructField("BarcodeBWR", StringType(), True),
			StructField("CutterReference", StringType(), True),
			StructField("CustomerDesignRef", StringType(), True),
			StructField("UnwindCode", StringType(), True),
			StructField("EyeMarkSizeX", StringType(), True),
			StructField("EyeMarkSizeY", StringType(), True),
			StructField("Substrate", StringType(), True),
			StructField("InterslittingSize", StringType(), True),
			StructField("InterslittingQty", StringType(), True),
			StructField("ContinuousPrint", StringType(), True),
			StructField("ButtJoin", StringType(), True),
			StructField("BleedLeft", StringType(), True),
			StructField("BleedRight", StringType(), True),
			StructField("CentreTrim", StringType(), True),
			StructField("SlitPosition", StringType(), True),
			StructField("SlitPositionSize", StringType(), True),
			StructField("Stepped", StringType(), True),
			StructField("TargetPressName", StringType(), True),
			StructField("TargetPressType", StringType(), True),
			StructField("DisproATW", StringType(), True),
			StructField("AniloxType", StringType(), True),
			StructField("SmartmarkLegendNotes", StringType(), True),
			StructField("BarcodeNotes", StringType(), True),
			StructField("DisplaceOnStepping", StringType(), True),
			StructField("CDIResolution", StringType(), True),
			StructField("TotalHeight", StringType(), True),
			StructField("TotalWidth", StringType(), True),
			StructField("CutBack", StringType(), True),
			StructField("CDIPowerSetting", StringType(), True),
			StructField("FlatTopDot", StringType(), True),
			StructField("SurfaceScreening", StringType(), True),
			StructField("Revolutions", StringType(), True),
			StructField("ExposureTime", StringType(), True),
			StructField("HDHighlightDot", StringType(), True),
			StructField("PlateRelief", StringType(), True),
			StructField("StickyBack", StringType(), True),
			StructField("SlugCount", StringType(), True),
			StructField("OrderType", StringType(), True),
			StructField("Carrier", StringType(), True),
			StructField("BMCECTType", StringType(), True),
			StructField("Weight", StringType(), True),
			StructField("Size", StringType(), True),
			StructField("IncludeCustomerLogo", StringType(), True),
			StructField("MountMaterial", StringType(), True),
			StructField("AdditionalMountMaterial", StringType(), True),
			StructField("Centreline", StringType(), True),
			StructField("MaterialAround", StringType(), True),
			StructField("MaterialAcross", StringType(), True),
			StructField("CAD#", StringType(), True),
			StructField("GlueTab", StringType(), True),
			StructField("CADView", StringType(), True),
			StructField("CommonKnife", StringType(), True),
			StructField("Gutter", StringType(), True),
			StructField("CorrugateCurves", StringType(), True),
			StructField("PlatePunch", StringType(), True),
			StructField("GraphicsPickUp", StringType(), True),
			StructField("Cust1UpDie", StringType(), True),
			StructField("SuppliedFile", StringType(), True),
			StructField("SuppliedFormat", StringType(), True),
			StructField("SuppliedBy", StringType(), True),
			StructField("PlateReady", StringType(), True),
			StructField("PickUpJob", StringType(), True),
			StructField("CustStepDieNo", StringType(), True),
			StructField("NoUp", StringType(), True),
			StructField("MinSheetHeight", StringType(), True),
			StructField("MinSheetWidth", StringType(), True),
			StructField("MaxSheetHeight", StringType(), True),
			StructField("MaxSheetWidth", StringType(), True),
			StructField("Layback", StringType(), True),
			StructField("FirstKnife", StringType(), True),
			StructField("GripperDistance", StringType(), True),
			StructField("FillingStyle", StringType(), True),
			StructField("StartPointFillDirection", StringType(), True),
			StructField("ItemCodeVer", StringType(), True),
			StructField("Rewind", StringType(), True),
			StructField("SteppingPickUp", StringType(), True),
			StructField("GrossWeb", StringType(), True),
			StructField("MultiDesign", StringType(), True),
			StructField("NoColoursAffected", StringType(), True),
			StructField("Nested", StringType(), True),
			StructField("Spiral", StringType(), True),
			StructField("TurnAround", StringType(), True),
			StructField("SteppedDia", StringType(), True),
			StructField("OverallCylinderDia", StringType(), True),
			StructField("OverallCylinderCir", StringType(), True),
			StructField("FaceLength", StringType(), True),
			StructField("ChromePolish", StringType(), True),
			StructField("CustomerRZ", StringType(), True),
			StructField("RadiusSpec", StringType(), True),
			StructField("TestCutInfo", StringType(), True),
			StructField("StartingSide", StringType(), True),
			StructField("NarrowBarWidth", StringType(), True),
			StructField("BarcodeHeight", StringType(), True),
			StructField("BearerBars", StringType(), True),
			StructField("AutoGenerateBarcode", StringType(), True),
			StructField("PrinterSpecURL", StringType(), True),
			StructField("SymbolType", StringType(), True),
			StructField("CellSize", StringType(), True),
			StructField("Width", StringType(), True),
			StructField("AddCharacters", StringType(), True),
			StructField("PutTextOnTop", StringType(), True),
			StructField("AdditionalTextOffset", StringType(), True),
			StructField("InstancesInDesign", StringType(), True),
			StructField("MinimumSymbolSizeId", StringType(), True),
			StructField("ErrorCorrectionId", StringType(), True),
			StructField("PrintabilityGauges", StringType(), True),
			StructField("Ratio", StringType(), True),
			StructField("TextFormatId", StringType(), True)

])

# Initialize Spark session
spark = SparkSession.builder \
    .appName("Bronze to Silver Merge") \
    .config("spark.sql.extensions", "io.delta.sql.DeltaSparkSessionExtension") \
    .config("spark.sql.catalog.spark_catalog", "org.apache.spark.sql.delta.catalog.DeltaCatalog") \
    .getOrCreate()

    # Define the schema
schema = StructType([
            StructField("SYS_CHANGE_VERSION", StringType(), True),
			StructField("SYS_CHANGE_OPERATION", StringType(), True),
			StructField("JobTechSpecId", StringType(), True),
			StructField("JobVersionId", StringType(), True),
			StructField("JobCategory", StringType(), True),
			StructField("SurfaceReversePrint", StringType(), True),
			StructField("CylinderSize", StringType(), True),
			StructField("ReelWidth", StringType(), True),
			StructField("NumberAroundCylinder", StringType(), True),
			StructField("NumberAcrossCylinder", StringType(), True),
			StructField("Dispro", StringType(), True),
			StructField("DisproDirection", StringType(), True),
			StructField("DisproNonStandard", StringType(), True),
			StructField("PlateType", StringType(), True),
			StructField("PlateThickness", StringType(), True),
			StructField("PlateStagger", StringType(), True),
			StructField("PlateStaggerRolling", StringType(), True),
			StructField("FileName", StringType(), True),
			StructField("JobHeight", StringType(), True),
			StructField("JobWidth", StringType(), True),
			StructField("RotateJob90CDI", StringType(), True),
			StructField("RotateJob90IS", StringType(), True),
			StructField("PCMTypeProfile", StringType(), True),
			StructField("ProductionSystem", StringType(), True),
			StructField("BarcodeNumber", StringType(), True),
			StructField("BarcodeType", StringType(), True),
			StructField("BarcodeCol", StringType(), True),
			StructField("BarcodeLMI", StringType(), True),
			StructField("BarcodeMag", StringType(), True),
			StructField("BarcodeBWR", StringType(), True),
			StructField("CutterReference", StringType(), True),
			StructField("CustomerDesignRef", StringType(), True),
			StructField("UnwindCode", StringType(), True),
			StructField("EyeMarkSizeX", StringType(), True),
			StructField("EyeMarkSizeY", StringType(), True),
			StructField("Substrate", StringType(), True),
			StructField("InterslittingSize", StringType(), True),
			StructField("InterslittingQty", StringType(), True),
			StructField("ContinuousPrint", StringType(), True),
			StructField("ButtJoin", StringType(), True),
			StructField("BleedLeft", StringType(), True),
			StructField("BleedRight", StringType(), True),
			StructField("CentreTrim", StringType(), True),
			StructField("SlitPosition", StringType(), True),
			StructField("SlitPositionSize", StringType(), True),
			StructField("Stepped", StringType(), True),
			StructField("TargetPressName", StringType(), True),
			StructField("TargetPressType", StringType(), True),
			StructField("DisproATW", StringType(), True),
			StructField("AniloxType", StringType(), True),
			StructField("SmartmarkLegendNotes", StringType(), True),
			StructField("BarcodeNotes", StringType(), True),
			StructField("DisplaceOnStepping", StringType(), True),
			StructField("CDIResolution", StringType(), True),
			StructField("TotalHeight", StringType(), True),
			StructField("TotalWidth", StringType(), True),
			StructField("CutBack", StringType(), True),
			StructField("CDIPowerSetting", StringType(), True),
			StructField("FlatTopDot", StringType(), True),
			StructField("SurfaceScreening", StringType(), True),
			StructField("Revolutions", StringType(), True),
			StructField("ExposureTime", StringType(), True),
			StructField("HDHighlightDot", StringType(), True),
			StructField("PlateRelief", StringType(), True),
			StructField("StickyBack", StringType(), True),
			StructField("SlugCount", StringType(), True),
			StructField("OrderType", StringType(), True),
			StructField("Carrier", StringType(), True),
			StructField("BMCECTType", StringType(), True),
			StructField("Weight", StringType(), True),
			StructField("Size", StringType(), True),
			StructField("IncludeCustomerLogo", StringType(), True),
			StructField("MountMaterial", StringType(), True),
			StructField("AdditionalMountMaterial", StringType(), True),
			StructField("Centreline", StringType(), True),
			StructField("MaterialAround", StringType(), True),
			StructField("MaterialAcross", StringType(), True),
			StructField("CAD#", StringType(), True),
			StructField("GlueTab", StringType(), True),
			StructField("CADView", StringType(), True),
			StructField("CommonKnife", StringType(), True),
			StructField("Gutter", StringType(), True),
			StructField("CorrugateCurves", StringType(), True),
			StructField("PlatePunch", StringType(), True),
			StructField("GraphicsPickUp", StringType(), True),
			StructField("Cust1UpDie", StringType(), True),
			StructField("SuppliedFile", StringType(), True),
			StructField("SuppliedFormat", StringType(), True),
			StructField("SuppliedBy", StringType(), True),
			StructField("PlateReady", StringType(), True),
			StructField("PickUpJob", StringType(), True),
			StructField("CustStepDieNo", StringType(), True),
			StructField("NoUp", StringType(), True),
			StructField("MinSheetHeight", StringType(), True),
			StructField("MinSheetWidth", StringType(), True),
			StructField("MaxSheetHeight", StringType(), True),
			StructField("MaxSheetWidth", StringType(), True),
			StructField("Layback", StringType(), True),
			StructField("FirstKnife", StringType(), True),
			StructField("GripperDistance", StringType(), True),
			StructField("FillingStyle", StringType(), True),
			StructField("StartPointFillDirection", StringType(), True),
			StructField("ItemCodeVer", StringType(), True),
			StructField("Rewind", StringType(), True),
			StructField("SteppingPickUp", StringType(), True),
			StructField("GrossWeb", StringType(), True),
			StructField("MultiDesign", StringType(), True),
			StructField("NoColoursAffected", StringType(), True),
			StructField("Nested", StringType(), True),
			StructField("Spiral", StringType(), True),
			StructField("TurnAround", StringType(), True),
			StructField("SteppedDia", StringType(), True),
			StructField("OverallCylinderDia", StringType(), True),
			StructField("OverallCylinderCir", StringType(), True),
			StructField("FaceLength", StringType(), True),
			StructField("ChromePolish", StringType(), True),
			StructField("CustomerRZ", StringType(), True),
			StructField("RadiusSpec", StringType(), True),
			StructField("TestCutInfo", StringType(), True),
			StructField("StartingSide", StringType(), True),
			StructField("NarrowBarWidth", StringType(), True),
			StructField("BarcodeHeight", StringType(), True),
			StructField("BearerBars", StringType(), True),
			StructField("AutoGenerateBarcode", StringType(), True),
			StructField("PrinterSpecURL", StringType(), True),
			StructField("SymbolType", StringType(), True),
			StructField("CellSize", StringType(), True),
			StructField("Width", StringType(), True),
			StructField("AddCharacters", StringType(), True),
			StructField("PutTextOnTop", StringType(), True),
			StructField("AdditionalTextOffset", StringType(), True),
			StructField("InstancesInDesign", StringType(), True),
			StructField("MinimumSymbolSizeId", StringType(), True),
			StructField("ErrorCorrectionId", StringType(), True),
			StructField("PrintabilityGauges", StringType(), True),
			StructField("Ratio", StringType(), True),
			StructField("TextFormatId", StringType(), True)
])
# Create an empty DataFrame with the schema
df = spark.createDataFrame([], schema)

silver_path="abfss://SGSCo_Fabric_Development@onelake.dfs.fabric.microsoft.com/SILVER.Lakehouse/Tables/dbo/tbl_job_tech_spec"
silver_table = DeltaTable.forPath(spark, silver_path)
# Parameters
param = ""  # Replace with the actual PARAM value


# If-else logic to control the flow based on in_mode
if in_mode == "FULL":
    # Write the DataFrame as a Delta table
    df.write.format("delta").mode("overwrite").saveAsTable("tbl_job_tech_spec")
    bronze_Path ="abfss://SGSCo_Fabric_Development@onelake.dfs.fabric.microsoft.com/BRONZE.Lakehouse/Tables/MYSGSEU/tbl_job_tech_spec_FULL"
    # Load Delta tables correctly
    bronze_df = spark.read.format("delta").load(bronze_Path)
     
        # Merge data from Bronze Full to Silver
    silver_table.alias("target").merge(
           bronze_df.alias("source"),
           "target.JobTechSpecId = source.JobTechSpecId"
        ).whenMatchedUpdate(set={
        "SYS_CHANGE_VERSION": col("source.SYS_CHANGE_VERSION"),
        "SYS_CHANGE_OPERATION": col("source.SYS_CHANGE_OPERATION"),
        "JobTechSpecId": col("source.JobTechSpecId"),
        "JobVersionId": col("source.JobVersionId"),
        "JobCategory": col("source.JobCategory"),
        "SurfaceReversePrint": col("source.SurfaceReversePrint"),
        "CylinderSize": col("source.CylinderSize"),
        "ReelWidth": col("source.ReelWidth"),
        "NumberAroundCylinder": col("source.NumberAroundCylinder"),
        "NumberAcrossCylinder": col("source.NumberAcrossCylinder"),
        "Dispro": col("source.Dispro"),
        "DisproDirection": col("source.DisproDirection"),
        "DisproNonStandard": col("source.DisproNonStandard"),
        "PlateType": col("source.PlateType"),
        "PlateThickness": col("source.PlateThickness"),
        "PlateStagger": col("source.PlateStagger"),
        "PlateStaggerRolling": col("source.PlateStaggerRolling"),
        "FileName": col("source.FileName"),
        "JobHeight": col("source.JobHeight"),
        "JobWidth": col("source.JobWidth"),
        "RotateJob90CDI": col("source.RotateJob90CDI"),
        "RotateJob90IS": col("source.RotateJob90IS"),
        "PCMTypeProfile": col("source.PCMTypeProfile"),
        "ProductionSystem": col("source.ProductionSystem"),
        "BarcodeNumber": col("source.BarcodeNumber"),
        "BarcodeType": col("source.BarcodeType"),
        "BarcodeCol": col("source.BarcodeCol"),
        "BarcodeLMI": col("source.BarcodeLMI"),
        "BarcodeMag": col("source.BarcodeMag"),
        "BarcodeBWR": col("source.BarcodeBWR"),
        "CutterReference": col("source.CutterReference"),
        "CustomerDesignRef": col("source.CustomerDesignRef"),
        "UnwindCode": col("source.UnwindCode"),
        "EyeMarkSizeX": col("source.EyeMarkSizeX"),
        "EyeMarkSizeY": col("source.EyeMarkSizeY"),
        "Substrate": col("source.Substrate"),
        "InterslittingSize": col("source.InterslittingSize"),
        "InterslittingQty": col("source.InterslittingQty"),
        "ContinuousPrint": col("source.ContinuousPrint"),
        "ButtJoin": col("source.ButtJoin"),
        "BleedLeft": col("source.BleedLeft"),
        "BleedRight": col("source.BleedRight"),
        "CentreTrim": col("source.CentreTrim"),
        "SlitPosition": col("source.SlitPosition"),
        "SlitPositionSize": col("source.SlitPositionSize"),
        "Stepped": col("source.Stepped"),
        "TargetPressName": col("source.TargetPressName"),
        "TargetPressType": col("source.TargetPressType"),
        "DisproATW": col("source.DisproATW"),
        "AniloxType": col("source.AniloxType"),
        "SmartmarkLegendNotes": col("source.SmartmarkLegendNotes"),
        "BarcodeNotes": col("source.BarcodeNotes"),
        "DisplaceOnStepping": col("source.DisplaceOnStepping"),
        "CDIResolution": col("source.CDIResolution"),
        "TotalHeight": col("source.TotalHeight"),
        "TotalWidth": col("source.TotalWidth"),
        "CutBack": col("source.CutBack"),
        "CDIPowerSetting": col("source.CDIPowerSetting"),
        "FlatTopDot": col("source.FlatTopDot"),
        "SurfaceScreening": col("source.SurfaceScreening"),
        "Revolutions": col("source.Revolutions"),
        "ExposureTime": col("source.ExposureTime"),
        "HDHighlightDot": col("source.HDHighlightDot"),
        "PlateRelief": col("source.PlateRelief"),
        "StickyBack": col("source.StickyBack"),
        "SlugCount": col("source.SlugCount"),
        "OrderType": col("source.OrderType"),
        "Carrier": col("source.Carrier"),
        "BMCECTType": col("source.BMCECTType"),
        "Weight": col("source.Weight"),
        "Size": col("source.Size"),
        "IncludeCustomerLogo": col("source.IncludeCustomerLogo"),
        "MountMaterial": col("source.MountMaterial"),
        "AdditionalMountMaterial": col("source.AdditionalMountMaterial"),
        "Centreline": col("source.Centreline"),
        "MaterialAround": col("source.MaterialAround"),
        "MaterialAcross": col("source.MaterialAcross"),
        "CAD#": col("source.CAD#"),
        "GlueTab": col("source.GlueTab"),
        "CADView": col("source.CADView"),
        "CommonKnife": col("source.CommonKnife"),
        "Gutter": col("source.Gutter"),
        "CorrugateCurves": col("source.CorrugateCurves"),
        "PlatePunch": col("source.PlatePunch"),
        "GraphicsPickUp": col("source.GraphicsPickUp"),
        "Cust1UpDie": col("source.Cust1UpDie"),
        "SuppliedFile": col("source.SuppliedFile"),
        "SuppliedFormat": col("source.SuppliedFormat"),
        "SuppliedBy": col("source.SuppliedBy"),
        "PlateReady": col("source.PlateReady"),
        "PickUpJob": col("source.PickUpJob"),
        "CustStepDieNo": col("source.CustStepDieNo"),
        "NoUp": col("source.NoUp"),
        "MinSheetHeight": col("source.MinSheetHeight"),
        "MinSheetWidth": col("source.MinSheetWidth"),
        "MaxSheetHeight": col("source.MaxSheetHeight"),
        "MaxSheetWidth": col("source.MaxSheetWidth"),
        "Layback": col("source.Layback"),
        "FirstKnife": col("source.FirstKnife"),
        "GripperDistance": col("source.GripperDistance"),
        "FillingStyle": col("source.FillingStyle"),
        "StartPointFillDirection": col("source.StartPointFillDirection"),
        "ItemCodeVer": col("source.ItemCodeVer"),
        "Rewind": col("source.Rewind"),
        "SteppingPickUp": col("source.SteppingPickUp"),
        "GrossWeb": col("source.GrossWeb"),
        "MultiDesign": col("source.MultiDesign"),
        "NoColoursAffected": col("source.NoColoursAffected"),
        "Nested": col("source.Nested"),
        "Spiral": col("source.Spiral"),
        "TurnAround": col("source.TurnAround"),
        "SteppedDia": col("source.SteppedDia"),
        "OverallCylinderDia": col("source.OverallCylinderDia"),
        "OverallCylinderCir": col("source.OverallCylinderCir"),
        "FaceLength": col("source.FaceLength"),
        "ChromePolish": col("source.ChromePolish"),
        "CustomerRZ": col("source.CustomerRZ"),
        "RadiusSpec": col("source.RadiusSpec"),
        "TestCutInfo": col("source.TestCutInfo"),
        "StartingSide": col("source.StartingSide"),
        "NarrowBarWidth": col("source.NarrowBarWidth"),
        "BarcodeHeight": col("source.BarcodeHeight"),
        "BearerBars": col("source.BearerBars"),
        "AutoGenerateBarcode": col("source.AutoGenerateBarcode"),
        "PrinterSpecURL": col("source.PrinterSpecURL"),
        "SymbolType": col("source.SymbolType"),
        "CellSize": col("source.CellSize"),
        "Width": col("source.Width"),
        "AddCharacters": col("source.AddCharacters"),
        "PutTextOnTop": col("source.PutTextOnTop"),
        "AdditionalTextOffset": col("source.AdditionalTextOffset"),
        "InstancesInDesign": col("source.InstancesInDesign"),
        "MinimumSymbolSizeId": col("source.MinimumSymbolSizeId"),
        "ErrorCorrectionId": col("source.ErrorCorrectionId"),
        "PrintabilityGauges": col("source.PrintabilityGauges"),
        "Ratio": col("source.Ratio"),
        "TextFormatId": col("source.TextFormatId")

        }).whenNotMatchedInsert(values={
        "SYS_CHANGE_VERSION": col("source.SYS_CHANGE_VERSION"),
        "SYS_CHANGE_OPERATION": col("source.SYS_CHANGE_OPERATION"),
        "JobTechSpecId": col("source.JobTechSpecId"),        
        "JobVersionId": col("source.JobVersionId"),
        "JobCategory": col("source.JobCategory"),
        "SurfaceReversePrint": col("source.SurfaceReversePrint"),
        "CylinderSize": col("source.CylinderSize"),
        "ReelWidth": col("source.ReelWidth"),
        "NumberAroundCylinder": col("source.NumberAroundCylinder"),
        "NumberAcrossCylinder": col("source.NumberAcrossCylinder"),
        "Dispro": col("source.Dispro"),
        "DisproDirection": col("source.DisproDirection"),
        "DisproNonStandard": col("source.DisproNonStandard"),
        "PlateType": col("source.PlateType"),
        "PlateThickness": col("source.PlateThickness"),
        "PlateStagger": col("source.PlateStagger"),
        "PlateStaggerRolling": col("source.PlateStaggerRolling"),
        "FileName": col("source.FileName"),
        "JobHeight": col("source.JobHeight"),
        "JobWidth": col("source.JobWidth"),
        "RotateJob90CDI": col("source.RotateJob90CDI"),
        "RotateJob90IS": col("source.RotateJob90IS"),
        "PCMTypeProfile": col("source.PCMTypeProfile"),
        "ProductionSystem": col("source.ProductionSystem"),
        "BarcodeNumber": col("source.BarcodeNumber"),
        "BarcodeType": col("source.BarcodeType"),
        "BarcodeCol": col("source.BarcodeCol"),
        "BarcodeLMI": col("source.BarcodeLMI"),
        "BarcodeMag": col("source.BarcodeMag"),
        "BarcodeBWR": col("source.BarcodeBWR"),
        "CutterReference": col("source.CutterReference"),
        "CustomerDesignRef": col("source.CustomerDesignRef"),
        "UnwindCode": col("source.UnwindCode"),
        "EyeMarkSizeX": col("source.EyeMarkSizeX"),
        "EyeMarkSizeY": col("source.EyeMarkSizeY"),
        "Substrate": col("source.Substrate"),
        "InterslittingSize": col("source.InterslittingSize"),
        "InterslittingQty": col("source.InterslittingQty"),
        "ContinuousPrint": col("source.ContinuousPrint"),
        "ButtJoin": col("source.ButtJoin"),
        "BleedLeft": col("source.BleedLeft"),
        "BleedRight": col("source.BleedRight"),
        "CentreTrim": col("source.CentreTrim"),
        "SlitPosition": col("source.SlitPosition"),
        "SlitPositionSize": col("source.SlitPositionSize"),
        "Stepped": col("source.Stepped"),
        "TargetPressName": col("source.TargetPressName"),
        "TargetPressType": col("source.TargetPressType"),
        "DisproATW": col("source.DisproATW"),
        "AniloxType": col("source.AniloxType"),
        "SmartmarkLegendNotes": col("source.SmartmarkLegendNotes"),
        "BarcodeNotes": col("source.BarcodeNotes"),
        "DisplaceOnStepping": col("source.DisplaceOnStepping"),
        "CDIResolution": col("source.CDIResolution"),
        "TotalHeight": col("source.TotalHeight"),
        "TotalWidth": col("source.TotalWidth"),
        "CutBack": col("source.CutBack"),
        "CDIPowerSetting": col("source.CDIPowerSetting"),
        "FlatTopDot": col("source.FlatTopDot"),
        "SurfaceScreening": col("source.SurfaceScreening"),
        "Revolutions": col("source.Revolutions"),
        "ExposureTime": col("source.ExposureTime"),
        "HDHighlightDot": col("source.HDHighlightDot"),
        "PlateRelief": col("source.PlateRelief"),
        "StickyBack": col("source.StickyBack"),
        "SlugCount": col("source.SlugCount"),
        "OrderType": col("source.OrderType"),
        "Carrier": col("source.Carrier"),
        "BMCECTType": col("source.BMCECTType"),
        "Weight": col("source.Weight"),
        "Size": col("source.Size"),
        "IncludeCustomerLogo": col("source.IncludeCustomerLogo"),
        "MountMaterial": col("source.MountMaterial"),
        "AdditionalMountMaterial": col("source.AdditionalMountMaterial"),
        "Centreline": col("source.Centreline"),
        "MaterialAround": col("source.MaterialAround"),
        "MaterialAcross": col("source.MaterialAcross"),
        "CAD#": col("source.CAD#"),
        "GlueTab": col("source.GlueTab"),
        "CADView": col("source.CADView"),
        "CommonKnife": col("source.CommonKnife"),
        "Gutter": col("source.Gutter"),
        "CorrugateCurves": col("source.CorrugateCurves"),
        "PlatePunch": col("source.PlatePunch"),
        "GraphicsPickUp": col("source.GraphicsPickUp"),
        "Cust1UpDie": col("source.Cust1UpDie"),
        "SuppliedFile": col("source.SuppliedFile"),
        "SuppliedFormat": col("source.SuppliedFormat"),
        "SuppliedBy": col("source.SuppliedBy"),
        "PlateReady": col("source.PlateReady"),
        "PickUpJob": col("source.PickUpJob"),
        "CustStepDieNo": col("source.CustStepDieNo"),
        "NoUp": col("source.NoUp"),
        "MinSheetHeight": col("source.MinSheetHeight"),
        "MinSheetWidth": col("source.MinSheetWidth"),
        "MaxSheetHeight": col("source.MaxSheetHeight"),
        "MaxSheetWidth": col("source.MaxSheetWidth"),
        "Layback": col("source.Layback"),
        "FirstKnife": col("source.FirstKnife"),
        "GripperDistance": col("source.GripperDistance"),
        "FillingStyle": col("source.FillingStyle"),
        "StartPointFillDirection": col("source.StartPointFillDirection"),
        "ItemCodeVer": col("source.ItemCodeVer"),
        "Rewind": col("source.Rewind"),
        "SteppingPickUp": col("source.SteppingPickUp"),
        "GrossWeb": col("source.GrossWeb"),
        "MultiDesign": col("source.MultiDesign"),
        "NoColoursAffected": col("source.NoColoursAffected"),
        "Nested": col("source.Nested"),
        "Spiral": col("source.Spiral"),
        "TurnAround": col("source.TurnAround"),
        "SteppedDia": col("source.SteppedDia"),
        "OverallCylinderDia": col("source.OverallCylinderDia"),
        "OverallCylinderCir": col("source.OverallCylinderCir"),
        "FaceLength": col("source.FaceLength"),
        "ChromePolish": col("source.ChromePolish"),
        "CustomerRZ": col("source.CustomerRZ"),
        "RadiusSpec": col("source.RadiusSpec"),
        "TestCutInfo": col("source.TestCutInfo"),
        "StartingSide": col("source.StartingSide"),
        "NarrowBarWidth": col("source.NarrowBarWidth"),
        "BarcodeHeight": col("source.BarcodeHeight"),
        "BearerBars": col("source.BearerBars"),
        "AutoGenerateBarcode": col("source.AutoGenerateBarcode"),
        "PrinterSpecURL": col("source.PrinterSpecURL"),
        "SymbolType": col("source.SymbolType"),
        "CellSize": col("source.CellSize"),
        "Width": col("source.Width"),
        "AddCharacters": col("source.AddCharacters"),
        "PutTextOnTop": col("source.PutTextOnTop"),
        "AdditionalTextOffset": col("source.AdditionalTextOffset"),
        "InstancesInDesign": col("source.InstancesInDesign"),
        "MinimumSymbolSizeId": col("source.MinimumSymbolSizeId"),
        "ErrorCorrectionId": col("source.ErrorCorrectionId"),
        "PrintabilityGauges": col("source.PrintabilityGauges"),
        "Ratio": col("source.Ratio"),
        "TextFormatId": col("source.TextFormatId")

        }).execute()
else:
    df.write.format("delta").mode("append").saveAsTable("tbl_job_tech_spec")
    
    source_path = "abfss://SGSCo_Fabric_Development@onelake.dfs.fabric.microsoft.com/BRONZE.Lakehouse/Tables/MYSGSEU/tbl_job_tech_spec_DELTA"
    source_df_delta = spark.read.format("delta").load(source_path)

    # Filter the source DataFrame for "D" operations and select distinct CT_JobTechSpecId
    filtered_source_df = source_df_delta.filter(source_df_delta["SYS_CHANGE_OPERATION"] == "D") \
    .select("CT_JobTechSpecId") \
    .distinct()

   # Perform the MERGE operation
    silver_table.alias("T") \
    .merge(filtered_source_df.alias("S"), "T.JobTechSpecId = S.CT_JobTechSpecId") \
    .whenMatchedDelete() \
    .execute()

    # Perform the transformation with all required columns
    transformed_df = source_df_delta.alias("a").join(
        source_df_delta.groupBy("JobTechSpecId")
        .agg(spark_max(col("SYS_CHANGE_VERSION").cast("bigint")).alias("SYS_CHANGE_VERSION"))
        .alias("b"),
        (col("a.JobTechSpecId") == col("b.JobTechSpecId")) & 
        (col("a.SYS_CHANGE_VERSION").cast("bigint") == col("b.SYS_CHANGE_VERSION"))
    ).where(col("a.SYS_CHANGE_OPERATION") != 'D') \
    .select(
        col("a.SYS_CHANGE_VERSION"),
        col("a.SYS_CHANGE_OPERATION"),
        col("a.JobTechSpecId"),
			col("a.JobVersionId"),
			col("a.JobCategory"),
			col("a.SurfaceReversePrint"),
			col("a.CylinderSize"),
			col("a.ReelWidth"),
			col("a.NumberAroundCylinder"),
			col("a.NumberAcrossCylinder"),
			col("a.Dispro"),
			col("a.DisproDirection"),
			col("a.DisproNonStandard"),
			col("a.PlateType"),
			col("a.PlateThickness"),
			col("a.PlateStagger"),
			col("a.PlateStaggerRolling"),
			col("a.FileName"),
			col("a.JobHeight"),
			col("a.JobWidth"),
			col("a.RotateJob90CDI"),
			col("a.RotateJob90IS"),
			col("a.PCMTypeProfile"),
			col("a.ProductionSystem"),
			col("a.BarcodeNumber"),
			col("a.BarcodeType"),
			col("a.BarcodeCol"),
			col("a.BarcodeLMI"),
			col("a.BarcodeMag"),
			col("a.BarcodeBWR"),
			col("a.CutterReference"),
			col("a.CustomerDesignRef"),
			col("a.UnwindCode"),
			col("a.EyeMarkSizeX"),
			col("a.EyeMarkSizeY"),
			col("a.Substrate"),
			col("a.InterslittingSize"),
			col("a.InterslittingQty"),
			col("a.ContinuousPrint"),
			col("a.ButtJoin"),
			col("a.BleedLeft"),
			col("a.BleedRight"),
			col("a.CentreTrim"),
			col("a.SlitPosition"),
			col("a.SlitPositionSize"),
			col("a.Stepped"),
			col("a.TargetPressName"),
			col("a.TargetPressType"),
			col("a.DisproATW"),
			col("a.AniloxType"),
			col("a.SmartmarkLegendNotes"),
			col("a.BarcodeNotes"),
			col("a.DisplaceOnStepping"),
			col("a.CDIResolution"),
			col("a.TotalHeight"),
			col("a.TotalWidth"),
			col("a.CutBack"),
			col("a.CDIPowerSetting"),
			col("a.FlatTopDot"),
			col("a.SurfaceScreening"),
			col("a.Revolutions"),
			col("a.ExposureTime"),
			col("a.HDHighlightDot"),
			col("a.PlateRelief"),
			col("a.StickyBack"),
			col("a.SlugCount"),
			col("a.OrderType"),
			col("a.Carrier"),
			col("a.BMCECTType"),
			col("a.Weight"),
			col("a.Size"),
			col("a.IncludeCustomerLogo"),
			col("a.MountMaterial"),
			col("a.AdditionalMountMaterial"),
			col("a.Centreline"),
			col("a.MaterialAround"),
			col("a.MaterialAcross"),
			col("a.CAD#"),
			col("a.GlueTab"),
			col("a.CADView"),
			col("a.CommonKnife"),
			col("a.Gutter"),
			col("a.CorrugateCurves"),
			col("a.PlatePunch"),
			col("a.GraphicsPickUp"),
			col("a.Cust1UpDie"),
			col("a.SuppliedFile"),
			col("a.SuppliedFormat"),
			col("a.SuppliedBy"),
			col("a.PlateReady"),
			col("a.PickUpJob"),
			col("a.CustStepDieNo"),
			col("a.NoUp"),
			col("a.MinSheetHeight"),
			col("a.MinSheetWidth"),
			col("a.MaxSheetHeight"),
			col("a.MaxSheetWidth"),
			col("a.Layback"),
			col("a.FirstKnife"),
			col("a.GripperDistance"),
			col("a.FillingStyle"),
			col("a.StartPointFillDirection"),
			col("a.ItemCodeVer"),
			col("a.Rewind"),
			col("a.SteppingPickUp"),
			col("a.GrossWeb"),
			col("a.MultiDesign"),
			col("a.NoColoursAffected"),
			col("a.Nested"),
			col("a.Spiral"),
			col("a.TurnAround"),
			col("a.SteppedDia"),
			col("a.OverallCylinderDia"),
			col("a.OverallCylinderCir"),
			col("a.FaceLength"),
			col("a.ChromePolish"),
			col("a.CustomerRZ"),
			col("a.RadiusSpec"),
			col("a.TestCutInfo"),
			col("a.StartingSide"),
			col("a.NarrowBarWidth"),
			col("a.BarcodeHeight"),
			col("a.BearerBars"),
			col("a.AutoGenerateBarcode"),
			col("a.PrinterSpecURL"),
			col("a.SymbolType"),
			col("a.CellSize"),
			col("a.Width"),
			col("a.AddCharacters"),
			col("a.PutTextOnTop"),
			col("a.AdditionalTextOffset"),
			col("a.InstancesInDesign"),
			col("a.MinimumSymbolSizeId"),
			col("a.ErrorCorrectionId"),
			col("a.PrintabilityGauges"),
			col("a.Ratio"),
			col("a.TextFormatId")
    ).distinct()

    # Perform the MERGE operation
    silver_table.alias("target").merge(
        transformed_df.alias("source"),
        "target.JobTechSpecId = source.JobTechSpecId"
    ).whenMatchedUpdate(set={
        "SYS_CHANGE_VERSION": col("source.SYS_CHANGE_VERSION"),
        "SYS_CHANGE_OPERATION": col("source.SYS_CHANGE_OPERATION"),
        "JobTechSpecId": col("source.JobTechSpecId"),
        "JobVersionId": col("source.JobVersionId"),
        "JobCategory": col("source.JobCategory"),
        "SurfaceReversePrint": col("source.SurfaceReversePrint"),
        "CylinderSize": col("source.CylinderSize"),
        "ReelWidth": col("source.ReelWidth"),
        "NumberAroundCylinder": col("source.NumberAroundCylinder"),
        "NumberAcrossCylinder": col("source.NumberAcrossCylinder"),
        "Dispro": col("source.Dispro"),
        "DisproDirection": col("source.DisproDirection"),
        "DisproNonStandard": col("source.DisproNonStandard"),
        "PlateType": col("source.PlateType"),
        "PlateThickness": col("source.PlateThickness"),
        "PlateStagger": col("source.PlateStagger"),
        "PlateStaggerRolling": col("source.PlateStaggerRolling"),
        "FileName": col("source.FileName"),
        "JobHeight": col("source.JobHeight"),
        "JobWidth": col("source.JobWidth"),
        "RotateJob90CDI": col("source.RotateJob90CDI"),
        "RotateJob90IS": col("source.RotateJob90IS"),
        "PCMTypeProfile": col("source.PCMTypeProfile"),
        "ProductionSystem": col("source.ProductionSystem"),
        "BarcodeNumber": col("source.BarcodeNumber"),
        "BarcodeType": col("source.BarcodeType"),
        "BarcodeCol": col("source.BarcodeCol"),
        "BarcodeLMI": col("source.BarcodeLMI"),
        "BarcodeMag": col("source.BarcodeMag"),
        "BarcodeBWR": col("source.BarcodeBWR"),
        "CutterReference": col("source.CutterReference"),
        "CustomerDesignRef": col("source.CustomerDesignRef"),
        "UnwindCode": col("source.UnwindCode"),
        "EyeMarkSizeX": col("source.EyeMarkSizeX"),
        "EyeMarkSizeY": col("source.EyeMarkSizeY"),
        "Substrate": col("source.Substrate"),
        "InterslittingSize": col("source.InterslittingSize"),
        "InterslittingQty": col("source.InterslittingQty"),
        "ContinuousPrint": col("source.ContinuousPrint"),
        "ButtJoin": col("source.ButtJoin"),
        "BleedLeft": col("source.BleedLeft"),
        "BleedRight": col("source.BleedRight"),
        "CentreTrim": col("source.CentreTrim"),
        "SlitPosition": col("source.SlitPosition"),
        "SlitPositionSize": col("source.SlitPositionSize"),
        "Stepped": col("source.Stepped"),
        "TargetPressName": col("source.TargetPressName"),
        "TargetPressType": col("source.TargetPressType"),
        "DisproATW": col("source.DisproATW"),
        "AniloxType": col("source.AniloxType"),
        "SmartmarkLegendNotes": col("source.SmartmarkLegendNotes"),
        "BarcodeNotes": col("source.BarcodeNotes"),
        "DisplaceOnStepping": col("source.DisplaceOnStepping"),
        "CDIResolution": col("source.CDIResolution"),
        "TotalHeight": col("source.TotalHeight"),
        "TotalWidth": col("source.TotalWidth"),
        "CutBack": col("source.CutBack"),
        "CDIPowerSetting": col("source.CDIPowerSetting"),
        "FlatTopDot": col("source.FlatTopDot"),
        "SurfaceScreening": col("source.SurfaceScreening"),
        "Revolutions": col("source.Revolutions"),
        "ExposureTime": col("source.ExposureTime"),
        "HDHighlightDot": col("source.HDHighlightDot"),
        "PlateRelief": col("source.PlateRelief"),
        "StickyBack": col("source.StickyBack"),
        "SlugCount": col("source.SlugCount"),
        "OrderType": col("source.OrderType"),
        "Carrier": col("source.Carrier"),
        "BMCECTType": col("source.BMCECTType"),
        "Weight": col("source.Weight"),
        "Size": col("source.Size"),
        "IncludeCustomerLogo": col("source.IncludeCustomerLogo"),
        "MountMaterial": col("source.MountMaterial"),
        "AdditionalMountMaterial": col("source.AdditionalMountMaterial"),
        "Centreline": col("source.Centreline"),
        "MaterialAround": col("source.MaterialAround"),
        "MaterialAcross": col("source.MaterialAcross"),
        "CAD#": col("source.CAD#"),
        "GlueTab": col("source.GlueTab"),
        "CADView": col("source.CADView"),
        "CommonKnife": col("source.CommonKnife"),
        "Gutter": col("source.Gutter"),
        "CorrugateCurves": col("source.CorrugateCurves"),
        "PlatePunch": col("source.PlatePunch"),
        "GraphicsPickUp": col("source.GraphicsPickUp"),
        "Cust1UpDie": col("source.Cust1UpDie"),
        "SuppliedFile": col("source.SuppliedFile"),
        "SuppliedFormat": col("source.SuppliedFormat"),
        "SuppliedBy": col("source.SuppliedBy"),
        "PlateReady": col("source.PlateReady"),
        "PickUpJob": col("source.PickUpJob"),
        "CustStepDieNo": col("source.CustStepDieNo"),
        "NoUp": col("source.NoUp"),
        "MinSheetHeight": col("source.MinSheetHeight"),
        "MinSheetWidth": col("source.MinSheetWidth"),
        "MaxSheetHeight": col("source.MaxSheetHeight"),
        "MaxSheetWidth": col("source.MaxSheetWidth"),
        "Layback": col("source.Layback"),
        "FirstKnife": col("source.FirstKnife"),
        "GripperDistance": col("source.GripperDistance"),
        "FillingStyle": col("source.FillingStyle"),
        "StartPointFillDirection": col("source.StartPointFillDirection"),
        "ItemCodeVer": col("source.ItemCodeVer"),
        "Rewind": col("source.Rewind"),
        "SteppingPickUp": col("source.SteppingPickUp"),
        "GrossWeb": col("source.GrossWeb"),
        "MultiDesign": col("source.MultiDesign"),
        "NoColoursAffected": col("source.NoColoursAffected"),
        "Nested": col("source.Nested"),
        "Spiral": col("source.Spiral"),
        "TurnAround": col("source.TurnAround"),
        "SteppedDia": col("source.SteppedDia"),
        "OverallCylinderDia": col("source.OverallCylinderDia"),
        "OverallCylinderCir": col("source.OverallCylinderCir"),
        "FaceLength": col("source.FaceLength"),
        "ChromePolish": col("source.ChromePolish"),
        "CustomerRZ": col("source.CustomerRZ"),
        "RadiusSpec": col("source.RadiusSpec"),
        "TestCutInfo": col("source.TestCutInfo"),
        "StartingSide": col("source.StartingSide"),
        "NarrowBarWidth": col("source.NarrowBarWidth"),
        "BarcodeHeight": col("source.BarcodeHeight"),
        "BearerBars": col("source.BearerBars"),
        "AutoGenerateBarcode": col("source.AutoGenerateBarcode"),
        "PrinterSpecURL": col("source.PrinterSpecURL"),
        "SymbolType": col("source.SymbolType"),
        "CellSize": col("source.CellSize"),
        "Width": col("source.Width"),
        "AddCharacters": col("source.AddCharacters"),
        "PutTextOnTop": col("source.PutTextOnTop"),
        "AdditionalTextOffset": col("source.AdditionalTextOffset"),
        "InstancesInDesign": col("source.InstancesInDesign"),
        "MinimumSymbolSizeId": col("source.MinimumSymbolSizeId"),
        "ErrorCorrectionId": col("source.ErrorCorrectionId"),
        "PrintabilityGauges": col("source.PrintabilityGauges"),
        "Ratio": col("source.Ratio"),
        "TextFormatId": col("source.TextFormatId")
    }).whenNotMatchedInsert(values={
        "SYS_CHANGE_VERSION": col("source.SYS_CHANGE_VERSION"),
        "SYS_CHANGE_OPERATION": col("source.SYS_CHANGE_OPERATION"),
        "JobTechSpecId": col("source.JobTechSpecId"),
        "JobVersionId": col("source.JobVersionId"),
        "JobCategory": col("source.JobCategory"),
        "SurfaceReversePrint": col("source.SurfaceReversePrint"),
        "CylinderSize": col("source.CylinderSize"),
        "ReelWidth": col("source.ReelWidth"),
        "NumberAroundCylinder": col("source.NumberAroundCylinder"),
        "NumberAcrossCylinder": col("source.NumberAcrossCylinder"),
        "Dispro": col("source.Dispro"),
        "DisproDirection": col("source.DisproDirection"),
        "DisproNonStandard": col("source.DisproNonStandard"),
        "PlateType": col("source.PlateType"),
        "PlateThickness": col("source.PlateThickness"),
        "PlateStagger": col("source.PlateStagger"),
        "PlateStaggerRolling": col("source.PlateStaggerRolling"),
        "FileName": col("source.FileName"),
        "JobHeight": col("source.JobHeight"),
        "JobWidth": col("source.JobWidth"),
        "RotateJob90CDI": col("source.RotateJob90CDI"),
        "RotateJob90IS": col("source.RotateJob90IS"),
        "PCMTypeProfile": col("source.PCMTypeProfile"),
        "ProductionSystem": col("source.ProductionSystem"),
        "BarcodeNumber": col("source.BarcodeNumber"),
        "BarcodeType": col("source.BarcodeType"),
        "BarcodeCol": col("source.BarcodeCol"),
        "BarcodeLMI": col("source.BarcodeLMI"),
        "BarcodeMag": col("source.BarcodeMag"),
        "BarcodeBWR": col("source.BarcodeBWR"),
        "CutterReference": col("source.CutterReference"),
        "CustomerDesignRef": col("source.CustomerDesignRef"),
        "UnwindCode": col("source.UnwindCode"),
        "EyeMarkSizeX": col("source.EyeMarkSizeX"),
        "EyeMarkSizeY": col("source.EyeMarkSizeY"),
        "Substrate": col("source.Substrate"),
        "InterslittingSize": col("source.InterslittingSize"),
        "InterslittingQty": col("source.InterslittingQty"),
        "ContinuousPrint": col("source.ContinuousPrint"),
        "ButtJoin": col("source.ButtJoin"),
        "BleedLeft": col("source.BleedLeft"),
        "BleedRight": col("source.BleedRight"),
        "CentreTrim": col("source.CentreTrim"),
        "SlitPosition": col("source.SlitPosition"),
        "SlitPositionSize": col("source.SlitPositionSize"),
        "Stepped": col("source.Stepped"),
        "TargetPressName": col("source.TargetPressName"),
        "TargetPressType": col("source.TargetPressType"),
        "DisproATW": col("source.DisproATW"),
        "AniloxType": col("source.AniloxType"),
        "SmartmarkLegendNotes": col("source.SmartmarkLegendNotes"),
        "BarcodeNotes": col("source.BarcodeNotes"),
        "DisplaceOnStepping": col("source.DisplaceOnStepping"),
        "CDIResolution": col("source.CDIResolution"),
        "TotalHeight": col("source.TotalHeight"),
        "TotalWidth": col("source.TotalWidth"),
        "CutBack": col("source.CutBack"),
        "CDIPowerSetting": col("source.CDIPowerSetting"),
        "FlatTopDot": col("source.FlatTopDot"),
        "SurfaceScreening": col("source.SurfaceScreening"),
        "Revolutions": col("source.Revolutions"),
        "ExposureTime": col("source.ExposureTime"),
        "HDHighlightDot": col("source.HDHighlightDot"),
        "PlateRelief": col("source.PlateRelief"),
        "StickyBack": col("source.StickyBack"),
        "SlugCount": col("source.SlugCount"),
        "OrderType": col("source.OrderType"),
        "Carrier": col("source.Carrier"),
        "BMCECTType": col("source.BMCECTType"),
        "Weight": col("source.Weight"),
        "Size": col("source.Size"),
        "IncludeCustomerLogo": col("source.IncludeCustomerLogo"),
        "MountMaterial": col("source.MountMaterial"),
        "AdditionalMountMaterial": col("source.AdditionalMountMaterial"),
        "Centreline": col("source.Centreline"),
        "MaterialAround": col("source.MaterialAround"),
        "MaterialAcross": col("source.MaterialAcross"),
        "CAD#": col("source.CAD#"),
        "GlueTab": col("source.GlueTab"),
        "CADView": col("source.CADView"),
        "CommonKnife": col("source.CommonKnife"),
        "Gutter": col("source.Gutter"),
        "CorrugateCurves": col("source.CorrugateCurves"),
        "PlatePunch": col("source.PlatePunch"),
        "GraphicsPickUp": col("source.GraphicsPickUp"),
        "Cust1UpDie": col("source.Cust1UpDie"),
        "SuppliedFile": col("source.SuppliedFile"),
        "SuppliedFormat": col("source.SuppliedFormat"),
        "SuppliedBy": col("source.SuppliedBy"),
        "PlateReady": col("source.PlateReady"),
        "PickUpJob": col("source.PickUpJob"),
        "CustStepDieNo": col("source.CustStepDieNo"),
        "NoUp": col("source.NoUp"),
        "MinSheetHeight": col("source.MinSheetHeight"),
        "MinSheetWidth": col("source.MinSheetWidth"),
        "MaxSheetHeight": col("source.MaxSheetHeight"),
        "MaxSheetWidth": col("source.MaxSheetWidth"),
        "Layback": col("source.Layback"),
        "FirstKnife": col("source.FirstKnife"),
        "GripperDistance": col("source.GripperDistance"),
        "FillingStyle": col("source.FillingStyle"),
        "StartPointFillDirection": col("source.StartPointFillDirection"),
        "ItemCodeVer": col("source.ItemCodeVer"),
        "Rewind": col("source.Rewind"),
        "SteppingPickUp": col("source.SteppingPickUp"),
        "GrossWeb": col("source.GrossWeb"),
        "MultiDesign": col("source.MultiDesign"),
        "NoColoursAffected": col("source.NoColoursAffected"),
        "Nested": col("source.Nested"),
        "Spiral": col("source.Spiral"),
        "TurnAround": col("source.TurnAround"),
        "SteppedDia": col("source.SteppedDia"),
        "OverallCylinderDia": col("source.OverallCylinderDia"),
        "OverallCylinderCir": col("source.OverallCylinderCir"),
        "FaceLength": col("source.FaceLength"),
        "ChromePolish": col("source.ChromePolish"),
        "CustomerRZ": col("source.CustomerRZ"),
        "RadiusSpec": col("source.RadiusSpec"),
        "TestCutInfo": col("source.TestCutInfo"),
        "StartingSide": col("source.StartingSide"),
        "NarrowBarWidth": col("source.NarrowBarWidth"),
        "BarcodeHeight": col("source.BarcodeHeight"),
        "BearerBars": col("source.BearerBars"),
        "AutoGenerateBarcode": col("source.AutoGenerateBarcode"),
        "PrinterSpecURL": col("source.PrinterSpecURL"),
        "SymbolType": col("source.SymbolType"),
        "CellSize": col("source.CellSize"),
        "Width": col("source.Width"),
        "AddCharacters": col("source.AddCharacters"),
        "PutTextOnTop": col("source.PutTextOnTop"),
        "AdditionalTextOffset": col("source.AdditionalTextOffset"),
        "InstancesInDesign": col("source.InstancesInDesign"),
        "MinimumSymbolSizeId": col("source.MinimumSymbolSizeId"),
        "ErrorCorrectionId": col("source.ErrorCorrectionId"),
        "PrintabilityGauges": col("source.PrintabilityGauges"),
        "Ratio": col("source.Ratio"),
        "TextFormatId": col("source.TextFormatId")
    }).execute()
	

# METADATA ********************

# META {
# META   "language": "python",
# META   "language_group": "synapse_pyspark"
# META }
