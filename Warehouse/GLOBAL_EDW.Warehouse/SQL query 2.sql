ALTER TABLE [GLOBAL_EDW].[Propelis].[EDW_T_FACT_CO_CCCSUMM_CUR_D]
ADD [Cost Element Grouping] VARCHAR(100);
GO

[GLOBAL_EDW].[Propelis].[EDW_T_FACT_SAL_SALORDD_CUR_D]

SELECT 


UPDATE FACT
SET FACT.[Cost Element Grouping] =
    CASE 
        WHEN [Cost Element ID] IN ('0000410000','0000410001','0000410020','0000410100','0000410200','0000410210','0000422200',
    '0000412000','0000410105','0000410002','0000410030','0000410040','0000410050','0000410060',
    '0000410070','0000410005','0000410080','0000410300','0000413000','0000413100','0000414000',
    '0000414100','0000423000','0000423100','0000424000','0000424100','0000410310','0000410311',
    '0000420000','0000420100','0000440000','0000440010','0000440020','0000420002','0000422000',
    '0000440030','0000440040','0000440050','0000420110','0000420130','0000420140','0000410010',
    '0000410097','0000410099','0000422100','0000410012','0000410096','0000410015','0000410013',
    '0000410011') THEN 'Sales'

        WHEN [Cost Element ID] IN ('0000599999','0000500000','0000500005','0000500100','0000510000','0000510005','0000510010',
'0000510020','0000510021','0000510050','0000510060','0000510080','0000510085','0000510090',
'0000511000','0000520000','0000520010','0000520020','0000520021','0000520040','0000520050',
'0000520051','0000520052','0000520053','0000520054','0000520055','0000520056','0000520060',
'0000520061','0000520065','0000520070','0000520075','0000520076','0000520085','0000520099',
'0000520100','0000520110','0000530000','0000530010','0000530030','0000530050','0000530060',
'0000530090','0000531010','0000540000','0000540010','0000540400','0000540405','0000540415',
'0000540420','0000540425','0000540430','0000540435','0000540440','0000540445','0000540450',
'0000540455','0000540460','0000540465','0000540470','0000540700','0000540710','0000540900',
'0000520057','0000520199','0000520049','0000500010','0000540410','0000700800','0000530100',
'0000530110','0000500006') THEN 'Ext Materials'

        WHEN [Cost Element ID] IN ('0000566666','0000611030','0000611031','0000611500','0000611501','0000611036','0000610211',
'0000610220','0000610230','0000610510','0000610520','0000611000','0000611020','0000611050',
'0000611051','0000611059','0000612000','0000610200','0000610600','0000610610','0000610100',
'0000611056') THEN 'Salaries & Wage'

        WHEN [Cost Element ID] IN ('0000610210','0000610215') THEN 'OT / Dbl Time'

        WHEN [Cost Element ID] = '0000611010' THEN 'Commissions'

        WHEN [Cost Element ID] IN ('0000615000','0000615020','0000615040','0000615050','0000615060','0000615080','0000615100',
'0000615200','0000615010','0000615065','0000615090','0000615030','0000680050','0000647777',
'0000615070','0000615075') THEN 'Benefits'

        WHEN [Cost Element ID] IN ('0000630000','0000630010','0000630020','0000630030','0000630040','0000630050','0000630070',
'0000630080','0000630090','0000630100','0000630110','0000630120','0000630130','0000630140',
'0000630015','0000630072','0000630060','0000630071','0000630005','0000650085','0000653000',
'0000630013','0000610010','0000610020') THEN 'Purchase Services'

        WHEN [Cost Element ID] IN ('0000680150','0000680151','0000680152') THEN 'Leases'
        WHEN [Cost Element ID] = '0000680000' THEN 'Bad Debt'
        WHEN [Cost Element ID] IN ('0000620130','0000620190','0000645000','0000645100','0000646000','0000650090','0000680010',
'0000680020','0000680035','0000680045','0000680047','0000680060','0000680090','0000680095',
'0000680100','0000680110','0000680130','0000680131','0000680135','0000680138','0000680140',
'0000680160','0000680170','0000680180','0000680200','0000680201','0000680202','0000680203',
'0000680204','0000680210','0000680220','0000680230','0000680240','0000680250','0000690030',
'0000690050','0000690070','0000690090','0000690100','0000690125','0000690130','0000690140',
'0000690150','0000690160','0000690170','0000690180','0000680137','0000630105','0000615066',
'0000680046','0000680190','0000680260','0000680120','0000650500','0000655000','0000660000',
'0000680900','0000680042','0000680043','0000680901','0000680902','0000680904','0000680141',
'0000680142','0000680030','0000680040','0000650000','0000650005','0000650010','0000650015',
'0000650021','0000650022','0000650023','0000650024','0000650050','0000650060','0000650070',
'0000650075','0000650100','0000650105','0000650185','0000680070','0000680071','0000680072',
'0000680073','0000680074','0000680075','0000680076','0000680080','0000680081','0000690145') THEN 'Other Expenses'

        WHEN [Cost Element ID] IN ('0000577777','0000531000','0000654000') THEN 'Outbound Freight'
        WHEN [Cost Element ID] IN ('0000620000','0000620010','0000620020','0000620030','0000620040','0000620050','0000620060',
'0000620080','0000620090','0000620100','0000620110','0000620120','0000620135','0000620140',
'0000620150','0000620160','0000620170','0000620200','0000620210','0000620220','0000620230',
'0000620240','0000680215','0000620180','0000651000','0000652000') THEN 'Supplies'

        WHEN [Cost Element ID] IN ('0000650020','0000650110','0000650115','0000650120','0000650130','0000650135','0000650140',
'0000650145','0000650150','0000650160','0000650170','0000650180','0000650175','0000650190',
'0000610030','0000610040','0000610060','0000610070','0000610080','0000650153','0000650165',
'0000650155','0000650156') THEN 'T&E'

        WHEN [Cost Element ID] IN ('0000641000','0000641010','0000641020','0000641030','0000641040','0000641050','0000641070',
'0000641080','0000641200','0000641600','0000649999','0000640000','0000640010','0000640020',
'0000640030','0000640040','0000640050','0000640060','0000640070','0000640080','0000640200',
'0000641060') THEN 'Depr'

        WHEN [Cost Element ID] IN ('0000650030','0000650040','0000650045','0000650046','0000650047','0000650042','0000650080') THEN 'Vehicles'

        WHEN [Cost Element ID] IN ('0000611600','0000611601','0000690000','0000690110','0000690120','0000690001','0000699999',
'0000611111','0000622222','0000690060','0000690010') THEN 'Allocated Services'

        WHEN [Cost Element ID] IN ('0000691000') THEN 'STIP'

        WHEN [Cost Element ID] IN ('0000641430','0000648888','0000640430') THEN 'Amort'

        WHEN [Cost Element ID] IN ('0000500001','0000500002','0000500094','0000500095','0000500096','0000500097','0000540200',
'0000500093','0000520093','0000500003','0000510001','0000520120','0000520130','0000500098',
'0000520098','0000500099') THEN 'I/C'

        WHEN [Cost Element ID] IN ('0000700070','0000700100','0000700130','0000700400','0000700420','0000700075','0000700020',
'0000700030','0000700040','0000700050','0000700060','0000700110','0000700120','0000700210',
'0000710300','0000710500','0000710600','0000710800','0000711000','0000711100','0000711200',
'0000711300','0000700600','0000700610','0000701000','0000710700','0000700071','0000700072',
'0000710105','0000710100','0000710101','0000710975','0000710000','0000700005','0000700000',
'0000700010','0000700015','0000700080','0000700090','0000712000','0000710200','0000710400',
'0000710900','0000750000','0000750020','0000750040','0000750060','0000750080','0000750030',
'0000750300','0000750400','0000799999') THEN 'Other Inc / Exp (7Series)'
        WHEN [Cost Element Type] = 'Secondary' THEN 'Secondary'
        ELSE 'Needs Categorized'
    END
FROM [GLOBAL_EDW].[Propelis].[EDW_T_FACT_CO_CCCSUMM_CUR_D] AS FACT
LEFT JOIN [GLOBAL_EDW].[dbo].[EDW_T_D_MST_COSTELM_CUR_D] AS COSTELM
    ON FACT.[COST_ELEMNT_KEY] = COSTELM.[COST_ELEMNT_KEY];
-----------------------------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE [GLOBAL_EDW].[Propelis].[EDW_T_FACT_CO_CCCSUMM_CUR_D]
ADD [Value Type] VARCHAR(max);
-----------------------------------------------------------------------------------------------------------------------------------------------------
UPDATE [GLOBAL_EDW].[Propelis].[EDW_T_FACT_CO_CCCSUMM_CUR_D]
SET [Value Type] = 
    CASE 
        WHEN [Summary Value Type] = '11' THEN 'Statistical'
        ELSE 'Actual'
    END;
-----------------------------------------------------------------------------------------------------------------------------------------------------