CREATE    PROCEDURE [dbo].[Proc_EDW_T_D_MST_MATSALS_CUR_D]
AS
BEGIN
    
    UPDATE T
    SET
      T.[MATRL_SALES_KEY]	= S.[MATRL_SALES_KEY],
      T.[Material Sales ID]	= S.[MATRL_ID],
      T.[Material Sales Organization]	= S.[SALES_ORGZTN],
      T.[Material Sales Distribution Channel]	= S.[DISTRBN_CHNL],
      T.[Material Sales Statistics Group]	= S.[MATRL_STATISTICS_GROUP],
      T.[Material Sales Item Category Group]	= S.[ITM_CTGRY_GROUP],
      T.[Material Sales Account Assignment Group]	= S.[ACCT_ASSIGN_GRP],
      T.[Material Sales Delivering Plant]	= S.[DELIVERING_PLNT],
      T.[Material Sales Pricing Group]	= S.[MATRL_PRICING_GROUP],
      T.[Material Sales Commission Group]	= S.[COMM_GROUP],
      T.[Material Sales Group 1]	= S.[MATRL_GROUP_1],
      T.[Material Sales Group 2]	= S.[MATRL_GROUP_2],
      T.[Material Sales Group 3]	= S.[MATRL_GROUP_3],
      T.[Material Sales Group 4]	= S.[MATRL_GROUP_4],
      T.[Material Sales Group 5]	= S.[MATRL_GROUP_5],
      T.[ETL_SRC_SYS_CD]	= S.[ETL_SRC_SYS_CD],
      T.[ETL_EFFECTV_BEGIN_DATE]	= S.[ETL_EFFECTV_BEGIN_DATE],
      T.[ETL_EFFECTV_END_DATE]	= S.[ETL_EFFECTV_END_DATE],
      T.[ETL_CURR_RCD_IND]	= S.[ETL_CURR_RCD_IND],
      T.[ETL_CREATED_TS]	= S.[ETL_CREATED_TS],
      T.[ETL_UPDTD_TS]	= S.[ETL_UPDTD_TS],
      T.[Material Sales Organization Description]	= S.[SALES_ORG_DESC],
      T.[Material Sales Distribution Channel Description]	= S.[DISTRBN_CHNL_DESC],
      T.[Material Sales Statistics Group Description]	= S.[MATRL_STATISTICS_GROUP_DESC],
      T.[Material Sales Item Category Group Description]	= S.[ITM_CTGRY_GROUP_DESC],
      T.[Material Sales Account Assignment Group Description]	= S.[ACCT_ASSIGN_GRP_DESC],
      T.[Material Sales Pricing Group Description]	= S.[MATRL_PRICING_GROUP_DESC],
      T.[Material Sales Commission Group Description]	= S.[COMM_GROUP_DESC],
      T.[Material Sales Group 1 Description]	= S.[MATRL_GROUP_1_DESC],
      T.[Material Sales Group 2 Description]	= S.[MATRL_GROUP_2_DESC],
      T.[Material Sales Group 3 Description]	= S.[MATRL_GROUP_3_DESC],
      T.[Material Sales Group 4 Description]	= S.[MATRL_GROUP_4_DESC],
      T.[Material Sales Group 5 Description]	= S.[MATRL_GROUP_5_DESC],
      T.[Material Sales Product Hierarchy]	= S.[PRDT_HIERCHY],
      T.[Material Sales Product Hierarchy Description]	= S.[PRDT_HIERCHY_DESC],
      T.[Material Sales Level6 Product Category Code]	= S.[LEVEL6_PRDT_CTGRY_CD],
      T.[Material Sales Level6 Product Category Description]	= S.[LEVEL6_PRDT_CTGRY_DESC],
      T.[Material Sales Level5 Product Category Code]	= S.[LEVEL5_PRDT_CTGRY_CD],
      T.[Material Sales Level5 Product Category Code Description]	= S.[LEVEL5_PRDT_CTGRY_DESC],
      T.[Material Sales Level4 Product Category Code]	= S.[LEVEL4_PRDT_CTGRY_CD],
      T.[Material Sales Level4 Product Category Code Description]	= S.[LEVEL4_PRDT_CTGRY_DESC],
      T.[Material Sales Level3 Sub Family Code]	= S.[LEVEL3_SUB_FAMILY_CD],
      T.[Material Sales Level3 Sub Family Description]	= S.[LEVEL3_SUB_FAMILY_DESC],
      T.[Material Sales Level2 Family Code]	= S.[LEVEL2_FAMILY_CD],
      T.[Material Sales Level2 Family Code Description]	= S.[LEVEL2_FAMILY_DESC],
      T.[Material Sales Level1 Class Code]	= S.[LEVEL1_CLASS_CD],
      T.[Material Sales Level1 Class Description]	= S.[LEVEL1_CLASS_DESC],
      T.[Material Sales Text]	= S.[MATRL_SALES_TEXT],
      T.[SALES_UNIT]	= S.[SALES_UNIT],
      T.[CASH_DISCNT_IND]	= S.[CASH_DISCNT_IND],
      T.[DISTRBN_CHAIN_SPECIFIC_MATRL_ST]	= S.[DISTRBN_CHAIN_SPECIFIC_MATRL_ST],
      T.[DISTR_CHAIN_SPECIFIC_MATRL_STAT]	= S.[DISTR_CHAIN_SPECIFIC_MATRL_STAT],
      T.[PRICING_REF_MATRL]	 = S.[PRICING_REF_MATRL]
	

    FROM [GLOBAL_EDW].[dbo].[EDW_T_D_MST_MATSALS_CUR_D] AS T
    INNER JOIN [GLOBAL_EDW_MIRROR].[dbo].[EDW_T_D_MST_MATSALS_CUR_D] AS S
        ON T.[MATRL_SALES_KEY] = S.[MATRL_SALES_KEY];

    
    INSERT INTO [GLOBAL_EDW].[dbo].[EDW_T_D_MST_MATSALS_CUR_D] (
       [MATRL_SALES_KEY],
       [Material Sales ID],
       [Material Sales Organization],
       [Material Sales Distribution Channel],
       [Material Sales Statistics Group],
       [Material Sales Item Category Group],
       [Material Sales Account Assignment Group],
       [Material Sales Delivering Plant],
       [Material Sales Pricing Group],
       [Material Sales Commission Group],
       [Material Sales Group 1],
       [Material Sales Group 2],
       [Material Sales Group 3],
       [Material Sales Group 4],
       [Material Sales Group 5],
       [ETL_SRC_SYS_CD],
       [ETL_EFFECTV_BEGIN_DATE],
       [ETL_EFFECTV_END_DATE],
       [ETL_CURR_RCD_IND],
       [ETL_CREATED_TS],
       [ETL_UPDTD_TS],
       [Material Sales Organization Description],
       [Material Sales Distribution Channel Description],
       [Material Sales Statistics Group Description],
       [Material Sales Item Category Group Description],
       [Material Sales Account Assignment Group Description],
       [Material Sales Pricing Group Description],
       [Material Sales Commission Group Description],
       [Material Sales Group 1 Description],
       [Material Sales Group 2 Description],
       [Material Sales Group 3 Description],
       [Material Sales Group 4 Description],
       [Material Sales Group 5 Description],
       [Material Sales Product Hierarchy],
       [Material Sales Product Hierarchy Description],
       [Material Sales Level6 Product Category Code],
       [Material Sales Level6 Product Category Description],
       [Material Sales Level5 Product Category Code],
       [Material Sales Level5 Product Category Code Description],
       [Material Sales Level4 Product Category Code],
       [Material Sales Level4 Product Category Code Description],
       [Material Sales Level3 Sub Family Code],
       [Material Sales Level3 Sub Family Description],
       [Material Sales Level2 Family Code],
       [Material Sales Level2 Family Code Description],
       [Material Sales Level1 Class Code],
       [Material Sales Level1 Class Description],
       [Material Sales Text],
       [SALES_UNIT],
       [CASH_DISCNT_IND],
       [DISTRBN_CHAIN_SPECIFIC_MATRL_ST],
       [DISTR_CHAIN_SPECIFIC_MATRL_STAT],
       [PRICING_REF_MATRL]
    )
    SELECT
        S.[MATRL_SALES_KEY],
        S.[MATRL_ID],
        S.[SALES_ORGZTN],
        S.[DISTRBN_CHNL],
        S.[MATRL_STATISTICS_GROUP],
        S.[ITM_CTGRY_GROUP],
        S.[ACCT_ASSIGN_GRP],
        S.[DELIVERING_PLNT],
        S.[MATRL_PRICING_GROUP],
        S.[COMM_GROUP],
        S.[MATRL_GROUP_1],
        S.[MATRL_GROUP_2],
        S.[MATRL_GROUP_3],
        S.[MATRL_GROUP_4],
        S.[MATRL_GROUP_5],
        S.[ETL_SRC_SYS_CD],
        S.[ETL_EFFECTV_BEGIN_DATE],
        S.[ETL_EFFECTV_END_DATE],
        S.[ETL_CURR_RCD_IND],
        S.[ETL_CREATED_TS],
        S.[ETL_UPDTD_TS],
        S.[SALES_ORG_DESC],
        S.[DISTRBN_CHNL_DESC],
        S.[MATRL_STATISTICS_GROUP_DESC],
        S.[ITM_CTGRY_GROUP_DESC],
        S.[ACCT_ASSIGN_GRP_DESC],
        S.[MATRL_PRICING_GROUP_DESC],
        S.[COMM_GROUP_DESC],
        S.[MATRL_GROUP_1_DESC],
        S.[MATRL_GROUP_2_DESC],
        S.[MATRL_GROUP_3_DESC],
        S.[MATRL_GROUP_4_DESC],
        S.[MATRL_GROUP_5_DESC],
        S.[PRDT_HIERCHY],
        S.[PRDT_HIERCHY_DESC],
        S.[LEVEL6_PRDT_CTGRY_CD],
        S.[LEVEL6_PRDT_CTGRY_DESC],
        S.[LEVEL5_PRDT_CTGRY_CD],
        S.[LEVEL5_PRDT_CTGRY_DESC],
        S.[LEVEL4_PRDT_CTGRY_CD],
        S.[LEVEL4_PRDT_CTGRY_DESC],
        S.[LEVEL3_SUB_FAMILY_CD],
        S.[LEVEL3_SUB_FAMILY_DESC],
        S.[LEVEL2_FAMILY_CD],
        S.[LEVEL2_FAMILY_DESC],
        S.[LEVEL1_CLASS_CD],
        S.[LEVEL1_CLASS_DESC],
        S.[MATRL_SALES_TEXT],
        S.[SALES_UNIT],
        S.[CASH_DISCNT_IND],
        S.[DISTRBN_CHAIN_SPECIFIC_MATRL_ST],
        S.[DISTR_CHAIN_SPECIFIC_MATRL_STAT],
        S.[PRICING_REF_MATRL]

    FROM [GLOBAL_EDW_MIRROR].[dbo].[EDW_T_D_MST_MATSALS_CUR_D] AS S
    LEFT JOIN [GLOBAL_EDW].[dbo].[EDW_T_D_MST_MATSALS_CUR_D] AS T
        ON T.[MATRL_SALES_KEY] = S.[MATRL_SALES_KEY]
    WHERE T.[MATRL_SALES_KEY] IS NULL;

END